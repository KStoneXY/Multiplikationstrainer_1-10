<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Multiplikations‑Trainer (60 Aufgaben)</title>
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --panel-2: #0b1220;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --ok: #16a34a;
      --bad: #dc2626;
      --accent: #2563eb;
      --accent-2: #1d4ed8;
      --border: #1f2937;
      --card: #0b1220;
    }
    * { box-sizing: border-box; }
    body { margin:0; font-family: system-ui, sans-serif; background: linear-gradient(120deg, var(--bg), #0b1220 60%); color: var(--text); min-height:100vh; display:flex; flex-direction:column; }
    header { position:sticky; top:0; z-index:10; background:rgba(11,18,32,0.9); backdrop-filter:blur(6px); border-bottom:1px solid var(--border); }
    .wrap { max-width:1100px; margin:0 auto; padding:16px 20px; }
    h1 { font-size:1.5rem; margin:0 0 4px; }
    .sub { color:var(--muted); font-size:.95rem; }
    .controls { display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-top:12px; }
    button { border:1px solid var(--border); background:linear-gradient(180deg,var(--accent),var(--accent-2)); color:#fff; font-weight:600; padding:10px 14px; border-radius:12px; cursor:pointer; transition:transform .06s ease, filter .2s; box-shadow:0 6px 16px rgba(37,99,235,.25); }
    button.secondary { background:linear-gradient(180deg,#374151,#1f2937); box-shadow:0 6px 16px rgba(0,0,0,.25); }
    button:active { transform:translateY(1px); }
    button:disabled { opacity:.6; cursor:not-allowed; }
    .stats { display:flex; gap:16px; align-items:center; margin-left:auto; }
    .badge { background:#111827; border:1px solid var(--border); padding:8px 12px; border-radius:10px; font-variant-numeric:tabular-nums; }
    label { color:var(--muted); font-size:.95rem; }
    input[type="number"].limit {
      background:#0a0f1c; color:var(--text); border:1px solid #0e1628; border-radius:10px; padding:9px 12px; width:120px; outline:none;
    }
    main { flex:1; }
    .grid { display:grid; gap:10px; padding:18px 20px 32px; max-width:1100px; margin:0 auto; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); }
    .card { background:var(--card); border:1px solid var(--border); border-radius:14px; padding:12px; display:grid; grid-template-columns:auto 1fr; gap:8px 10px; align-items:center; }
    .expr { font-weight:700; }
    .equals { text-align:right; color:var(--muted); }
    input[type="number"] { width:100%; background:#0a0f1c; color:var(--text); border:1px solid #0e1628; border-radius:10px; padding:10px 12px; font-size:16px; outline:none; }
    input[type="number"]:focus { border-color:var(--accent); box-shadow:0 0 0 3px rgba(37,99,235,.25); }
    .ok { border-color:rgba(22,163,74,.6)!important; box-shadow:0 0 0 3px rgba(22,163,74,.18)!important; }
    .bad { border-color:rgba(220,38,38,.6)!important; box-shadow:0 0 0 3px rgba(220,38,38,.16)!important; }
    .footer { max-width:1100px; margin:6px auto 40px; padding:0 20px; color:var(--muted); font-size:.95rem; }
    .sr-only { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Multiplikations‑Trainer <span class="sub">— 60 Aufgaben (1×1 bis 10×10)</span></h1>
      <div class="controls">
        <button id="startBtn">Start</button>
        <button id="stopBtn" class="secondary" disabled>Stop</button>
        <button id="restartBtn" class="secondary">Neu starten</button>
        <label for="timeLimitInput">Zeitlimit (Minuten, 0 = kein Limit):</label>
        <input id="timeLimitInput" type="number" class="limit" value="3" min="0" step="1" />
        <div class="stats">
          <div class="badge">⏱️ Zeit: <span id="time">00:00</span></div>
          <div class="badge">✅ Richtig: <span id="correct">0</span>/60</div>
        </div>
      </div>
    </div>
  </header>
  <main>
    <div id="grid" class="grid" aria-live="polite"></div>
    <p class="footer">Tipp: Mit <strong>Enter</strong> bestätigst du deine Eingabe. Ergebnisse (richtig/falsch) siehst du erst, wenn du <em>Stop</em> drückst oder das <em>Zeitlimit</em> erreicht ist.</p>
  </main>
  <script>
    const TOTAL = 60;
    let problems = [];
    let startTime = null;
    let timerId = null;
    let started = false;
    let finished = false;
    let timeLimitMs = 180000; // default 3 min

    const grid = document.getElementById('grid');
    const timeEl = document.getElementById('time');
    const correctEl = document.getElementById('correct');
    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const restartBtn = document.getElementById('restartBtn');
    const timeLimitInput = document.getElementById('timeLimitInput');

    function rand(min,max){return Math.floor(Math.random()*(max-min+1))+min;}
    function makeProblems(){problems=Array.from({length:TOTAL},()=>({a:rand(1,10),b:rand(1,10),user:''}));}
    function render(){grid.innerHTML=''; problems.forEach((p,i)=>{const card=document.createElement('div'); card.className='card'; card.innerHTML=`<div class="expr">${p.a} × ${p.b}</div><div class="equals">=</div>`; const input=document.createElement('input'); input.type='number'; input.dataset.index=i; input.value=p.user; input.disabled=!started; input.addEventListener('keydown',e=>{if(e.key==='Enter'){e.preventDefault(); advanceFrom(input);}}); input.addEventListener('input',()=>{p.user=input.value; input.classList.remove('ok','bad');}); card.appendChild(input); grid.appendChild(card);});}
    function advanceFrom(inp){let idx=+inp.dataset.index; for(let i=idx+1;i<problems.length;i++){let el=document.querySelector(`input[data-index="${i}"]`); if(el&&!el.disabled){el.focus();el.select();return;}} for(let i=0;i<=idx;i++){let el=document.querySelector(`input[data-index="${i}"]`); if(el&&!el.disabled){el.focus();el.select();return;}}}
    function formatTime(ms){let total=Math.max(0,Math.floor(ms/1000)); let m=String(Math.floor(total/60)).padStart(2,'0'); let s=String(total%60).padStart(2,'0'); return `${m}:${s}`;}
    function startTimer(){startTime=Date.now(); timerId=setInterval(()=>{let elapsed=Date.now()-startTime; timeEl.textContent=formatTime(elapsed); if(timeLimitMs>0 && elapsed>=timeLimitMs){finish('time');}},200);} 
    function stopTimer(){if(timerId){clearInterval(timerId); timerId=null;}}
    function gradeAll(){let correct=0; problems.forEach((p,i)=>{let expected=p.a*p.b; let val=Number((p.user||'').trim()); let ok=Number.isFinite(val)&&val===expected; if(ok) correct++; let input=document.querySelector(`input[data-index="${i}"]`); if(input){input.classList.toggle('ok',ok); input.classList.toggle('bad',!ok); input.disabled=true;}}); correctEl.textContent=String(correct); return correct;}
    function finish(reason='stop'){if(!started||finished)return; finished=true; stopTimer(); started=false; startBtn.disabled=false; stopBtn.disabled=true; let totalCorrect=gradeAll(); let elapsed=Date.now()-startTime; let msg=reason==='time'?`Zeit abgelaufen! ${totalCorrect}/${TOTAL} korrekt in ${formatTime(elapsed)}.`:`Beendet! ${totalCorrect}/${TOTAL} korrekt in ${formatTime(elapsed)}.`; alert(msg);}
    function reset(newSet=false){stopTimer(); started=false; finished=false; correctEl.textContent='0'; timeEl.textContent='00:00'; startBtn.disabled=false; stopBtn.disabled=true; if(newSet) makeProblems(); problems.forEach(p=>p.user=''); render();}
    function start(){if(!started){started=true; finished=false; startBtn.disabled=true; stopBtn.disabled=false; Array.from(grid.querySelectorAll('input')).forEach(el=>{el.disabled=false; el.classList.remove('ok','bad');}); startTimer(); let first=grid.querySelector('input[data-index="0"]'); if(first){first.focus();first.select();}}}

    startBtn.addEventListener('click',start);
    stopBtn.addEventListener('click',()=>finish('stop'));
    restartBtn.addEventListener('click',()=>reset(true));
    timeLimitInput.addEventListener('change',()=>{let min=Number(timeLimitInput.value); if(!isNaN(min)&&min>=0){ timeLimitMs=min*60000; }});

    makeProblems(); render();
  </script>
</body>
</html>
