<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Multiplikations‑Trainer (60 Aufgaben)</title>
  <style>
    :root {
      --bg: #0f172a;           /* slate-900 */
      --panel: #111827;        /* gray-900 */
      --panel-2: #0b1220;      
      --text: #e5e7eb;         /* gray-200 */
      --muted: #9ca3af;        /* gray-400 */
      --ok: #16a34a;           /* green-600 */
      --bad: #dc2626;          /* red-600 */
      --accent: #2563eb;       /* blue-600 */
      --accent-2: #1d4ed8;     /* blue-700 */
      --border: #1f2937;       /* gray-800 */
      --card: #0b1220;         
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: linear-gradient(120deg, var(--bg), #0b1220 60%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      position: sticky; top: 0; z-index: 10;
      background: rgba(11, 18, 32, 0.9);
      backdrop-filter: blur(6px);
      border-bottom: 1px solid var(--border);
    }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 16px 20px; }
    h1 { font-size: 1.5rem; margin: 0 0 4px; letter-spacing: .2px; }
    .sub { color: var(--muted); font-size: .95rem; }
    .controls { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; margin-top: 12px; }
    button {
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--accent), var(--accent-2));
      color: #fff; font-weight: 600; padding: 10px 14px; border-radius: 12px; cursor: pointer;
      transition: transform .06s ease, filter .2s; box-shadow: 0 6px 16px rgba(37,99,235,.25);
    }
    button.secondary { background: linear-gradient(180deg, #374151, #1f2937); box-shadow: 0 6px 16px rgba(0,0,0,.25); }
    button:active { transform: translateY(1px); }
    button:disabled { opacity: .6; cursor: not-allowed; }

    .stats { display: flex; gap: 16px; align-items: center; margin-left: auto; }
    .badge { background: #111827; border: 1px solid var(--border); padding: 8px 12px; border-radius: 10px; font-variant-numeric: tabular-nums; }

    main { flex: 1; }
    .grid {
      display: grid; gap: 10px; padding: 18px 20px 32px; max-width: 1100px; margin: 0 auto;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    }
    .card {
      background: var(--card); border: 1px solid var(--border); border-radius: 14px;
      padding: 12px; display: grid; grid-template-columns: auto 1fr; gap: 8px 10px; align-items: center;
    }
    .expr { font-weight: 700; letter-spacing: .3px; }
    .equals { text-align: right; color: var(--muted); }
    input[type="number"] {
      width: 100%; background: #0a0f1c; color: var(--text);
      border: 1px solid #0e1628; border-radius: 10px; padding: 10px 12px;
      font-size: 16px; font-variant-numeric: tabular-nums; outline: none;
      transition: border-color .15s ease, box-shadow .15s ease;
    }
    input[type="number"]:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(37,99,235,.25); }
    .ok { border-color: rgba(22,163,74,.6) !important; box-shadow: 0 0 0 3px rgba(22,163,74,.18) !important; }
    .bad { border-color: rgba(220,38,38,.6) !important; box-shadow: 0 0 0 3px rgba(220,38,38,.16) !important; }

    .footer { max-width: 1100px; margin: 6px auto 40px; padding: 0 20px; color: var(--muted); font-size: .95rem; }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Multiplikations‑Trainer <span class="sub">— 60 Aufgaben (1×1 bis 10×10)</span></h1>
      <div class="controls">
        <button id="startBtn">Start</button>
        <button id="restartBtn" class="secondary">Neu starten</button>
        <div class="stats">
          <div class="badge">⏱️ Zeit: <span id="time">00:00</span></div>
          <div class="badge">✅ Richtig: <span id="correct">0</span>/60</div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div id="grid" class="grid" aria-live="polite"></div>
    <p class="footer">Tipp: Mit der <strong>Enter‑Taste</strong> bestätigst du deine Eingabe und springst automatisch zur nächsten Aufgabe. Starte zuerst den Timer.</p>
  </main>

  <script>
    // --- State ---
    const TOTAL = 60;
    let problems = [];
    let startTime = null;
    let timerId = null;
    let correctCount = 0;
    let started = false;

    const grid = document.getElementById('grid');
    const timeEl = document.getElementById('time');
    const correctEl = document.getElementById('correct');
    const startBtn = document.getElementById('startBtn');
    const restartBtn = document.getElementById('restartBtn');

    function rand(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }

    function makeProblems() {
      problems = Array.from({ length: TOTAL }, () => ({ a: rand(1,10), b: rand(1,10), user: '', ok: false }));
    }

    function render() {
      grid.innerHTML = '';
      problems.forEach((p, idx) => {
        const card = document.createElement('div');
        card.className = 'card';
        const expr = document.createElement('div');
        expr.className = 'expr';
        expr.textContent = `${p.a} × ${p.b}`;
        const equals = document.createElement('div');
        equals.className = 'equals';
        equals.textContent = '=';
        const input = document.createElement('input');
        input.type = 'number';
        input.inputMode = 'numeric';
        input.autocomplete = 'off';
        input.placeholder = '…';
        input.ariaLabel = `${p.a} mal ${p.b}`;
        input.dataset.index = idx.toString();
        input.value = p.user;
        if (!started) input.disabled = true;
        if (p.ok) input.classList.add('ok');

        input.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            e.preventDefault();
            checkAndAdvance(input);
          }
        });

        input.addEventListener('input', () => {
          problems[idx].user = input.value;
          input.classList.remove('ok','bad');
        });

        card.appendChild(expr);
        card.appendChild(equals);
        card.appendChild(input);
        grid.appendChild(card);
      });
    }

    function checkAndAdvance(currentInput) {
      const idx = Number(currentInput.dataset.index);
      const p = problems[idx];
      const expected = p.a * p.b;
      const val = Number(currentInput.value.trim());
      if (Number.isFinite(val) && val === expected) {
        if (!p.ok) { p.ok = true; correctCount++; correctEl.textContent = String(correctCount); }
        currentInput.classList.remove('bad');
        currentInput.classList.add('ok');
        currentInput.setAttribute('disabled', 'true');
        focusNext(idx + 1);
        if (correctCount === TOTAL) finish();
      } else {
        currentInput.classList.remove('ok');
        currentInput.classList.add('bad');
      }
    }

    function focusNext(startIdx) {
      for (let i = startIdx; i < problems.length; i++) {
        const el = document.querySelector(`input[data-index="${i}"]`);
        if (el && !el.disabled) { el.focus(); el.select(); return; }
      }
      // wrap around to the first remaining
      for (let i = 0; i < problems.length; i++) {
        const el = document.querySelector(`input[data-index="${i}"]`);
        if (el && !el.disabled) { el.focus(); el.select(); return; }
      }
    }

    function formatTime(ms) {
      const total = Math.floor(ms / 1000);
      const m = String(Math.floor(total / 60)).padStart(2,'0');
      const s = String(total % 60).padStart(2,'0');
      return `${m}:${s}`;
    }

    function startTimer() {
      startTime = Date.now();
      timerId = setInterval(() => {
        const elapsed = Date.now() - startTime;
        timeEl.textContent = formatTime(elapsed);
      }, 200);
    }

    function stopTimer() { if (timerId) { clearInterval(timerId); timerId = null; } }

    function finish() {
      stopTimer();
      started = false;
      startBtn.disabled = false;
      startBtn.textContent = 'Erneut starten';
      // announce completion for screen readers
      const done = document.createElement('div');
      done.className = 'sr-only';
      done.textContent = `Geschafft in ${timeEl.textContent}`;
      document.body.appendChild(done);
      setTimeout(() => done.remove(), 1000);
      alert(`Super! Du hast alle ${TOTAL} Aufgaben in ${timeEl.textContent} geschafft.`);
    }

    function reset(newSet = false) {
      stopTimer();
      started = false;
      correctCount = 0; correctEl.textContent = '0';
      timeEl.textContent = '00:00';
      startBtn.disabled = false; startBtn.textContent = 'Start';
      problems.forEach(p => { p.user = ''; p.ok = false; });
      if (newSet) makeProblems();
      render();
    }

    function start() {
      if (!started) {
        started = true;
        startBtn.disabled = true;
        Array.from(grid.querySelectorAll('input')).forEach((el,i) => el.disabled = false);
        startTimer();
        // focus first
        const first = grid.querySelector('input[data-index="0"]');
        if (first) { first.focus(); first.select(); }
      }
    }

    // --- Wire up ---
    startBtn.addEventListener('click', start);
    restartBtn.addEventListener('click', () => { reset(true); });

    // --- Init: generate once so all 60 sind sichtbar ---
    makeProblems();
    render();
  </script>
</body>
</html>
